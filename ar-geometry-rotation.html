<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Rotasi Transformasi Geometri - Kelas IX</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.5/aframe/build/aframe-ar.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-size: 14px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            flex: 1;
            min-width: 150px;
            padding: 15px 20px;
            background: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            color: #667eea;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .tab-content.active {
            display: block;
        }

        .control-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .shape-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .shape-btn {
            padding: 15px;
            background: white;
            border: 3px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-weight: bold;
        }

        .shape-btn:hover {
            border-color: #667eea;
            transform: scale(1.05);
        }

        .shape-btn.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .rotation-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        .rotation-btn {
            padding: 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .rotation-btn:hover {
            background: #764ba2;
            transform: scale(1.05);
        }

        .custom-rotation {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .custom-rotation input {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .canvas-container {
            background: white;
            border: 3px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
            min-height: 400px;
        }

        canvas {
            display: block;
            margin: 0 auto;
            border: 1px solid #ddd;
        }

        .coordinates-display {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .coordinates-display h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .coord-row {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: white;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .ar-container {
            position: relative;
            width: 100%;
            height: 600px;
            border-radius: 10px;
            overflow: hidden;
        }

        .ar-overlay {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            background: rgba(255,255,255,0.9);
            padding: 15px;
            border-radius: 10px;
            z-index: 1000;
        }

        .ar-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .ar-controls button {
            padding: 10px 15px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .theory-section {
            line-height: 1.8;
        }

        .theory-section h2 {
            color: #667eea;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .theory-section h3 {
            color: #764ba2;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .formula-box {
            background: #f8f9fa;
            padding: 20px;
            border-left: 5px solid #667eea;
            margin: 20px 0;
            border-radius: 5px;
        }

        .example-box {
            background: #fff9e6;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        #startAR {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 20px;
        }

        #startAR:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .info-box {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 5px solid #2196F3;
        }

        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab-btn {
                width: 100%;
            }

            canvas {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🔄 Media Pembelajaran AR - Rotasi Transformasi Geometri</h1>
            <p class="subtitle">Kelas IX | Matematika | Interaktif & Augmented Reality</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('materi')">📚 Materi</button>
            <button class="tab-btn" onclick="switchTab('simulasi')">🎮 Simulasi 2D</button>
            <button class="tab-btn" onclick="switchTab('ar')">🔮 Mode AR</button>
        </div>

        <!-- Tab Materi -->
        <div id="materi" class="tab-content active">
            <div class="theory-section">
                <h2>Rotasi dalam Transformasi Geometri</h2>
                
                <h3>Pengertian Rotasi</h3>
                <p>Rotasi adalah transformasi geometri yang memindahkan setiap titik pada suatu bidang dengan cara memutarnya pada sudut tertentu terhadap suatu titik pusat (pivot point). Rotasi mempertahankan bentuk dan ukuran objek, hanya mengubah posisinya.</p>

                <div class="info-box">
                    <strong>💡 Catatan Penting:</strong> Rotasi memiliki tiga komponen utama:
                    <ul style="margin-top: 10px;">
                        <li>Titik pusat rotasi (biasanya titik O(0,0))</li>
                        <li>Besar sudut rotasi (θ)</li>
                        <li>Arah rotasi (searah atau berlawanan jarum jam)</li>
                    </ul>
                </div>

                <h3>Rumus Rotasi dengan Pusat O(0,0)</h3>
                <div class="formula-box">
                    <p><strong>Rotasi 90° berlawanan arah jarum jam:</strong></p>
                    <p>P(x, y) → P'(-y, x)</p>
                    
                    <p style="margin-top: 15px;"><strong>Rotasi 180°:</strong></p>
                    <p>P(x, y) → P'(-x, -y)</p>
                    
                    <p style="margin-top: 15px;"><strong>Rotasi 270° berlawanan arah jarum jam (atau 90° searah):</strong></p>
                    <p>P(x, y) → P'(y, -x)</p>
                    
                    <p style="margin-top: 15px;"><strong>Rotasi θ derajat (rumus umum):</strong></p>
                    <p>x' = x cos θ - y sin θ</p>
                    <p>y' = x sin θ + y cos θ</p>
                </div>

                <div class="example-box">
                    <h4>📝 Contoh Soal:</h4>
                    <p><strong>Soal:</strong> Titik A(3, 4) dirotasi 90° berlawanan arah jarum jam dengan pusat O(0,0). Tentukan koordinat bayangan titik A!</p>
                    
                    <p style="margin-top: 15px;"><strong>Penyelesaian:</strong></p>
                    <p>Diketahui: A(3, 4), rotasi 90° berlawanan arah jarum jam</p>
                    <p>Rumus: P(x, y) → P'(-y, x)</p>
                    <p>Maka: A'(-4, 3)</p>
                    <p><strong>Jadi, koordinat bayangan titik A adalah A'(-4, 3)</strong></p>
                </div>

                <h3>Sifat-sifat Rotasi</h3>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li>Jarak titik ke pusat rotasi tetap (kongruen)</li>
                    <li>Besar sudut yang dibentuk dengan pusat rotasi tetap</li>
                    <li>Bentuk dan ukuran bangun tidak berubah (isometri)</li>
                    <li>Orientasi bangun dapat berubah</li>
                </ul>
            </div>
        </div>

        <!-- Tab Simulasi 2D -->
        <div id="simulasi" class="tab-content">
            <div class="control-panel">
                <div class="control-group">
                    <label>1️⃣ Pilih Bentuk Geometri:</label>
                    <div class="shape-selector">
                        <button class="shape-btn selected" onclick="selectShape('triangle')">🔺 Segitiga</button>
                        <button class="shape-btn" onclick="selectShape('square')">⬛ Persegi</button>
                        <button class="shape-btn" onclick="selectShape('rectangle')">▭ Persegi Panjang</button>
                        <button class="shape-btn" onclick="selectShape('pentagon')">⬟ Segi Lima</button>
                    </div>
                </div>

                <div class="control-group">
                    <label>2️⃣ Pilih Sudut Rotasi:</label>
                    <div class="rotation-controls">
                        <button class="rotation-btn" onclick="rotate(90)">90°</button>
                        <button class="rotation-btn" onclick="rotate(180)">180°</button>
                        <button class="rotation-btn" onclick="rotate(270)">270°</button>
                        <button class="rotation-btn" onclick="rotate(-90)">-90°</button>
                    </div>
                </div>

                <div class="control-group">
                    <label>3️⃣ Atau Masukkan Sudut Custom:</label>
                    <div class="custom-rotation">
                        <input type="number" id="customAngle" placeholder="Masukkan sudut (derajat)" value="45">
                        <button class="rotation-btn" onclick="rotateCustom()">Rotasi!</button>
                    </div>
                </div>

                <div class="control-group">
                    <button class="rotation-btn" onclick="resetRotation()" style="width: 100%; background: #dc3545;">🔄 Reset</button>
                </div>
            </div>

            <div class="canvas-container">
                <canvas id="geometryCanvas" width="600" height="400"></canvas>
            </div>

            <div class="coordinates-display">
                <h3>📊 Koordinat Titik-Titik</h3>
                <div id="coordinatesInfo"></div>
            </div>
        </div>

        <!-- Tab AR -->
        <div id="ar" class="tab-content">
            <div class="info-box">
                <strong>📱 Cara Menggunakan Mode AR:</strong>
                <ol style="margin-top: 10px; margin-left: 20px;">
                    <li>Klik tombol "Mulai AR" di bawah</li>
                    <li>Izinkan akses kamera pada browser Anda</li>
                    <li>Pilih bentuk geometri yang ingin ditampilkan</li>
                    <li>Gunakan kontrol untuk merotasi objek 3D</li>
                    <li>Arahkan kamera ke permukaan datar atau gunakan marker Hiro</li>
                </ol>
            </div>

            <button id="startAR" onclick="startAR()">🚀 Mulai Mode AR</button>

            <div id="arScene" style="display: none;">
                <div class="ar-overlay">
                    <strong>Kontrol AR:</strong>
                    <div class="ar-controls">
                        <button onclick="changeARShape('box')">📦 Kubus</button>
                        <button onclick="changeARShape('cone')">🔺 Kerucut</button>
                        <button onclick="changeARShape('cylinder')">🥫 Silinder</button>
                        <button onclick="changeARShape('sphere')">⚪ Bola</button>
                        <button onclick="rotateAR(90)">↻ 90°</button>
                        <button onclick="rotateAR(180)">↻ 180°</button>
                        <button onclick="rotateAR(-90)">↺ -90°</button>
                        <button onclick="stopAR()" style="background: #dc3545;">❌ Stop AR</button>
                    </div>
                </div>

                <a-scene
                    embedded
                    arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
                    vr-mode-ui="enabled: false"
                    renderer="logarithmicDepthBuffer: true; precision: medium;">
                    
                    <a-marker preset="hiro">
                        <a-box 
                            id="arShape" 
                            position="0 0.5 0" 
                            material="color: #667eea;"
                            animation="property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear">
                        </a-box>
                        
                        <a-plane 
                            position="0 0 0" 
                            rotation="-90 0 0" 
                            width="2" 
                            height="2" 
                            color="#7BC8A4" 
                            opacity="0.5">
                        </a-plane>
                    </a-marker>

                    <a-entity camera></a-entity>
                </a-scene>
            </div>
        </div>
    </div>

    <script>
        let canvas, ctx;
        let currentShape = 'triangle';
        let currentRotation = 0;
        let shapes = {};
        let arRotation = 0;

        // Initialize canvas
        function initCanvas() {
            canvas = document.getElementById('geometryCanvas');
            ctx = canvas.getContext('2d');
            defineShapes();
            drawScene();
        }

        // Define shape coordinates
        function defineShapes() {
            shapes = {
                triangle: [
                    {x: 0, y: -50},
                    {x: -43, y: 25},
                    {x: 43, y: 25}
                ],
                square: [
                    {x: -40, y: -40},
                    {x: 40, y: -40},
                    {x: 40, y: 40},
                    {x: -40, y: 40}
                ],
                rectangle: [
                    {x: -60, y: -30},
                    {x: 60, y: -30},
                    {x: 60, y: 30},
                    {x: -60, y: 30}
                ],
                pentagon: [
                    {x: 0, y: -50},
                    {x: 47, y: -15},
                    {x: 29, y: 40},
                    {x: -29, y: 40},
                    {x: -47, y: -15}
                ]
            };
        }

        // Draw coordinate system and shapes
        function drawScene() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            // Draw grid
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            for(let i = 0; i <= canvas.width; i += 20) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            for(let i = 0; i <= canvas.height; i += 20) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(canvas.width, i);
                ctx.stroke();
            }

            // Draw axes
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, canvas.height);
            ctx.moveTo(0, centerY);
            ctx.lineTo(canvas.width, centerY);
            ctx.stroke();

            // Draw original shape
            drawShape(shapes[currentShape], centerX, centerY, 'rgba(102, 126, 234, 0.3)', 'rgba(102, 126, 234, 0.8)');

            // Draw rotated shape
            const rotatedPoints = rotatePoints(shapes[currentShape], currentRotation);
            drawShape(rotatedPoints, centerX, centerY, 'rgba(118, 75, 162, 0.5)', '#764ba2');

            // Update coordinates display
            updateCoordinatesDisplay(shapes[currentShape], rotatedPoints);
        }

        // Draw a shape
        function drawShape(points, offsetX, offsetY, fillColor, strokeColor) {
            ctx.fillStyle = fillColor;
            ctx.strokeStyle = strokeColor;
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(offsetX + points[0].x, offsetY - points[0].y);
            for(let i = 1; i < points.length; i++) {
                ctx.lineTo(offsetX + points[i].x, offsetY - points[i].y);
            }
            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            // Draw points
            points.forEach((point, index) => {
                ctx.fillStyle = strokeColor;
                ctx.beginPath();
                ctx.arc(offsetX + point.x, offsetY - point.y, 5, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = '#000';
                ctx.font = 'bold 12px Arial';
                ctx.fillText(`P${index + 1}`, offsetX + point.x + 10, offsetY - point.y - 10);
            });
        }

        // Rotate points
        function rotatePoints(points, angle) {
            const rad = (angle * Math.PI) / 180;
            return points.map(p => ({
                x: p.x * Math.cos(rad) - p.y * Math.sin(rad),
                y: p.x * Math.sin(rad) + p.y * Math.cos(rad)
            }));
        }

        // Update coordinates display
        function updateCoordinatesDisplay(original, rotated) {
            const display = document.getElementById('coordinatesInfo');
            let html = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">';
            
            html += '<div><h4 style="color: #667eea;">Koordinat Awal</h4>';
            original.forEach((p, i) => {
                html += `<div class="coord-row">P${i+1}: (${Math.round(p.x)}, ${Math.round(p.y)})</div>`;
            });
            html += '</div>';
            
            html += '<div><h4 style="color: #764ba2;">Koordinat Setelah Rotasi ' + currentRotation + '°</h4>';
            rotated.forEach((p, i) => {
                html += `<div class="coord-row">P${i+1}\': (${Math.round(p.x)}, ${Math.round(p.y)})</div>`;
            });
            html += '</div>';
            
            html += '</div>';
            display.innerHTML = html;
        }

        // Select shape
        function selectShape(shape) {
            currentShape = shape;
            document.querySelectorAll('.shape-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            drawScene();
        }

        // Rotate by preset angle
        function rotate(angle) {
            currentRotation += angle;
            drawScene();
        }

        // Rotate by custom angle
        function rotateCustom() {
            const angle = parseInt(document.getElementById('customAngle').value) || 0;
            currentRotation += angle;
            drawScene();
        }

        // Reset rotation
        function resetRotation() {
            currentRotation = 0;
            drawScene();
        }

        // Switch tabs
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if(tabName === 'simulasi') {
                setTimeout(initCanvas, 100);
            }
        }

        // AR Functions
        function startAR() {
            document.getElementById('startAR').style.display = 'none';
            document.getElementById('arScene').style.display = 'block';
        }

        function stopAR() {
            document.getElementById('startAR').style.display = 'block';
            document.getElementById('arScene').style.display = 'none';
        }

        function changeARShape(shapeType) {
            const arShape = document.getElementById('arShape');
            const scene = arShape.parentElement;
            const position = arShape.getAttribute('position');
            const currentRotation = arShape.getAttribute('rotation');
            
            arShape.remove();
            
            let newShape;
            const color = '#667eea';
            
            switch(shapeType) {
                case 'box':
                    newShape = document.createElement('a-box');
                    break;
                case 'cone':
                    newShape = document.createElement('a-cone');
                    break;
                case 'cylinder':
                    newShape = document.createElement('a-cylinder');
                    break;
                case 'sphere':
                    newShape = document.createElement('a-sphere');
                    break;
            }
            
            newShape.setAttribute('id', 'arShape');
            newShape.setAttribute('position', position);
            newShape.setAttribute('rotation', currentRotation);
            newShape.setAttribute('material', `color: ${color}`);
            newShape.setAttribute('animation', 'property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear');
            
            scene.appendChild(newShape);
        }

        function rotateAR(angle) {
            const arShape = document.getElementById('arShape');
            if(arShape) {
                arRotation += angle;
                arShape.setAttribute('rotation', `0 ${arRotation} 0`);
            }
        }

        // Initialize on load
        window.addEventListener('load', () => {
            initCanvas();
        });
    </script>
</body>
</html>